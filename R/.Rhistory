head(estrogen)
colnames(estrogen) <- c("pvals", "ord_high", "ord_mod")
save(file = "~/study/software/adapt/data/estrogen.RData", estrogen)
head(estrogen)
colnames(estrogen) <- c("pvals", "ord", "ord_mod")
colnames(estrogen) <- c("pvals", "ord_high", "ord_mod")
detach("package:adaptMT")
devtools::install_github("lihualei71/adaptMT")
head(estrogen)
head(estrogen)
i <- 1
x[1:100]
a
rejections
IHW::rejections
IHW
ihw
ihw
adaptMT
adata
adapt
ihw
dataset
devtools::install_github("lihualei71/adaptMT")
library("adaptMT")
adapt
?adapt
devtools::install_github("lihualei71/adaptMT")
library("adaptMT")
?adapt
adapt_glm
?adapt_glm
?adapt
devtools::install_github("lihualei71/adaptMT")
library("adaptMT")
?adapt
     res <- adapt(x = x, pvals = pvals, models = models,
                  dist = dist, nfits = 10, s0 = rep(0.1, length(pvals)))
     res <- adapt(x = x, pvals = pvals, models = models,
                  dist = dist, nfits = 10, s0 = rep(0.03, length(pvals)))
?estrogen
?adapt_glm
?adapt
?adapt_glm
?estrogen
?adapt_glm
?adapt_gam
?adapt_glmnet
?iris
?Estep_mix
Estep_mix
adaptMT:::Estep_mix
?exp_family
e
e
a
load("../data/GEOquery_random_ihw.RData")
NumRej_list
Reduce(mean, NumRej_list)
Reduce(sum, NumRej_list)
res
?adapt_glm
length(res$params)
length(res$params[[1]])
names(res$params[[1]])
res$models
res$models[[length(res$models)]]
length(res$models)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
tmp <- corr_lfdr(res)
summary(lfdr)
model
models
obj$models
obj$models[[1]]
model
length(obj$models)
obj$models[[2]]
obj$models[[1]]
obj$models[[2]]
obj$models[[3]]
corr
summary(oracle_lfdr)
model
summary(oracle_params$pix)
summary(oracle_params$mux)
corr
length(obj$models)
Q
length(res$models)
?adapt
?adapt_glm
length(res$models)
length(res$params)
res$models[[2]]
res$models[[1]]
res$models[[10]]
tmp <- corr_lfdr(res)
Q
tmp <- corr_lfdr(res)
tmp$corr
plot_1d_lfdr(obj1, 0.1, "")
x <- obj1$data[["x"]]
?adapt_glm
?adapt
adaptMT::corr_lfdr
obj1$alphas
ncol(res_corr$lfdr)
res_corr$alphas
res_corr$alphas
aaa <- par(xlim = c(1, 10))
1-res_corr$lfdr[H0, 10]
summary(1-res_corr$lfdr[H0, 10])
summary(1-res_corr$lfdr[!H0, 10])
summary(1-res_corr$lfdr[!H0, 16])
summary(1-res_corr$lfdr[H0, 16])
length(obj$params)
obj$params[[1]]$alpha
obj$params[[20]]$alpha
obj$params[[30]]$alpha
plot_1d_params(obj, 0.1, "")
plot_1d_thresh(obj, 0.1, "")
plot_1d_thresh(obj, 0.3, "")
plot_1d_thresh(obj1, 0.05, "", xlim = c(1, 11))
plot_1d_thresh(obj1, 0.05, "")
plot_1d_thresh(obj1, 0.05, "")
plot_1d_thresh(obj1, 0.05, "", xlim = c(1, 11))
plot_1d_lfdr(obj1, 0.05, "", xlim = c(1, 11))
?plot_1d
dev.off()
dev.off()
plot_1d_thresh(obj1, 0.05, "", xlim = c(1, 20000))
plot_1d_lfdr(obj1, 0.05, "", xlim = c(1, 20000))
plot_1d_thresh(obj1, 0.05, "", xlim = c(1, 20000))
plot_1d_lfdr(obj1, 0.05, "", xlim = c(1, 20000))
plot_1d_lfdr(obj1, 0.05, "", xlim = c(1, 20000))
Q
i <- 1
plot_1d_lfdr(result$adapt, 0.1, "")
plot_1d_lfdr(result$adapt, 0.1, "", disp_ymax = 0.1)
result$adapt$models
a
